# ğŸ«€ ECG ê¸°ë°˜ ì‹¬ê·¼ ë¹„ëŒ€ì¦(HCM) ì¡°ê¸° ì§„ë‹¨ ë° í´ë˜ìŠ¤ ë¶ˆê· í˜• ë¬¸ì œ í•´ê²°

-ë³¸ í”„ë¡œì íŠ¸ëŠ” ì‹¬ì „ë„(ECG) ë°ì´í„°ë¥¼ ì´ìš©í•´ **ì‹¬ê·¼ ë¹„ëŒ€ì¦(Hypertrophic Cardiomyopathy, HCM)** ì„ ì¡°ê¸°ì— ì§„ë‹¨í•˜ê³ , ì˜ë£Œ ë°ì´í„°ì—ì„œ í”íˆ ë°œìƒí•˜ëŠ” **í´ë˜ìŠ¤ ë¶ˆê· í˜• ë¬¸ì œ**ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•œ AI ëª¨ë¸ ê°œë°œì„ ëª©í‘œë¡œ í•©ë‹ˆë‹¤.
---

## ğŸ” ë°°ê²½

- **ECG(ì‹¬ì „ë„)**ëŠ” ë¹„ì¹¨ìŠµì ìœ¼ë¡œ ì‹¬ì¥ ìƒíƒœë¥¼ í‰ê°€í•  ìˆ˜ ìˆëŠ” ëŒ€í‘œì ì¸ ìƒì²´ì‹ í˜¸ì…ë‹ˆë‹¤.  
- **ì‹¬ê·¼ ë¹„ëŒ€ì¦(HCM)**ì€ ì‹¬ì¥ ê·¼ìœ¡ì´ ë¹„ì •ìƒì ìœ¼ë¡œ ë‘êº¼ì›Œì§€ëŠ” ì§ˆí™˜ìœ¼ë¡œ,  
  ì¡°ê¸° ì§„ë‹¨í•˜ì§€ ì•Šìœ¼ë©´ ì‹¬ë¶€ì „, ë¶€ì •ë§¥ ë“± ì¹˜ëª…ì ì¸ í•©ë³‘ì¦ìœ¼ë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.  
- í•˜ì§€ë§Œ ì‹¤ì œ ì„ìƒ ë°ì´í„°ì—ì„œ **ë¹„ëŒ€ì¦ í™˜ìì˜ ìˆ˜ëŠ” ë§¤ìš° ì ì–´ í´ë˜ìŠ¤ ë¶ˆê· í˜• ë¬¸ì œê°€ ì¡´ì¬**í•©ë‹ˆë‹¤.

---
## ğŸ§ª í”„ë¡œì íŠ¸ ê°œìš”

![image](https://github.com/user-attachments/assets/e4012787-57de-4de7-b419-ed160fa2da42)
- *ë°ì´í„° ìˆ˜ì§‘ë¶€í„° ì˜ˆì¸¡ ëª¨ë¸ ìƒì„±ê¹Œì§€ì˜ ì „ì²´ íë¦„*

---
## ğŸ©º ë°ì´í„° ì •ë³´

- **ì¶œì²˜**: [PTB-XL](https://physionet.org/content/ptb-xl/1.0.1/) (PhysioNet ê³µê°œ ECG ë°ì´í„°ì…‹)
- **í™˜ì ìˆ˜**: 18,869ëª…  
- **ì´ ê¸°ë¡ ìˆ˜**: 21,799ê°œì˜ 10ì´ˆ ê¸¸ì´ ECG  
- **ì„±ë¹„**: 52% ë‚¨ì„± / 48% ì—¬ì„±  
- **ì—°ë ¹ ë¶„í¬**: 0 ~ 95ì„¸ (ì¤‘ê°„ê°’ 62, ë¶„ìœ„ìˆ˜ ë²”ìœ„ 22)

<img src="https://github.com/user-attachments/assets/78647f3b-bd48-4086-9172-0943c5192670" width="200"/>

## ğŸ·ï¸ í´ë˜ìŠ¤ êµ¬ì„±

![image](https://github.com/user-attachments/assets/654f8a8d-50ec-41eb-bab8-ea307f042f19)


| í´ë˜ìŠ¤ | ì„¤ëª… | ìƒ˜í”Œ ìˆ˜ |
|--------|------|----------|
| NORM   | ì •ìƒ ì‹¬ì „ë„ | 9514 |
| HYP    | ì‹¬ê·¼ ë¹„ëŒ€ì¦ | 2649 |
| ê¸°íƒ€   | ST ë³€í™”, ì „ë„ ì¥ì•  ë“± | ë‚˜ë¨¸ì§€ |

- ë³¸ ì—°êµ¬ì—ì„œëŠ” **NORM vs HYP (ì •ìƒ vs ë¹„ëŒ€ì¦)** ì´ì§„ ë¶„ë¥˜ë¡œ ì„¤ì •  
- í´ë˜ìŠ¤ ë¶„í¬ëŠ” ì•½ **4:1**ë¡œ **ì‹¬í•œ í´ë˜ìŠ¤ ë¶ˆê· í˜• ì¡´ì¬**
<img src="https://github.com/user-attachments/assets/98680b26-6792-4a40-9806-77bdd5e22da3" width="200"/>
<img src="https://github.com/user-attachments/assets/53854bb5-9672-47da-909d-84d08084918a" width="200"/>

## âš™ï¸ ë°ì´í„° êµ¬ì„± ë° ì²˜ë¦¬

- ë ˆì´ë¸”: `HYP â†’ 0`, `NORM â†’ 1`ë¡œ ë³€í™˜
- ë°ì´í„° ë¶„í•  ë¹„ìœ¨: `train:val:test = 7:2:1`
- ì˜ë£Œ ë°ì´í„° íŠ¹ì„±ìƒ **ë°ì´í„° ì¦ê°•ì€ ì ìš©í•˜ì§€ ì•ŠìŒ**

---

## ğŸ§  ë¶ˆê· í˜• ë¬¸ì œ í•´ê²° ì „ëµ

| ê¸°ë²• | ì„¤ëª… |
|------|------|
| `Class Weighting` | ì†ì‹¤ í•¨ìˆ˜ì— í´ë˜ìŠ¤ ë¹„ìœ¨ ê¸°ë°˜ ê°€ì¤‘ì¹˜ ë¶€ì—¬ |
| `Focal Loss` | Hard exampleì— ë” ì§‘ì¤‘ |
| `Weighted Random Sampling` | í•™ìŠµ ì‹œ ì†Œìˆ˜ í´ë˜ìŠ¤ ìƒ˜í”Œ ìš°ì„  ì„ íƒ |
| `Cost-sensitive Learning` | FP/FN ë¹„ìš© ì°¨ì´ë¥¼ ê³ ë ¤í•œ ì†ì‹¤ í•¨ìˆ˜ |
| `Under Sampling` | ë‹¤ìˆ˜ í´ë˜ìŠ¤ ì¼ë¶€ ì œê±°í•˜ì—¬ ê· í˜• ì¡°ì • |

## ğŸ§ª ì‹¤í—˜ ê²°ê³¼

ë³¸ ì—°êµ¬ì—ì„œëŠ” ë‹¤ì–‘í•œ ë”¥ëŸ¬ë‹ ëª¨ë¸(RNN, CNN, ResNet, VGG ë“±)ì„ ë¹„êµ ë¶„ì„í–ˆìœ¼ë©°,  
CNN ê³„ì—´ì˜ ëª¨ë¸ì—ì„œ ê°€ì¥ ìš°ìˆ˜í•œ ì„±ëŠ¥ì„ ë³´ì˜€ê³ , **SEBlock**ê³¼ **Class Weight ì¡°ì •**ì„ í†µí•´ ë¶ˆê· í˜• ë¬¸ì œë¥¼ íš¨ê³¼ì ìœ¼ë¡œ í•´ê²°í–ˆìŠµë‹ˆë‹¤.

<img src="https://github.com/user-attachments/assets/0d5c46f2-7d53-4ff8-be5a-d353e66e038e" width="350"/>
## ğŸ§± ëª¨ë¸ ì•„í‚¤í…ì²˜: CNN2D

ë³¸ ì—°êµ¬ì—ì„œ ìµœì¢…ì ìœ¼ë¡œ ì±„íƒëœ CNN2D êµ¬ì¡°ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

```python
import torch.nn as nn

class CNN2D(nn.Module):
    def __init__(self, num_classes):
        super(CNN2D, self).__init__()

        self.conv1 = nn.Conv2d(in_channels=1, out_channels=100, kernel_size=(10, 10))
        self.conv2 = nn.Conv2d(in_channels=100, out_channels=250, kernel_size=(10, 10))
        self.conv3 = nn.Conv2d(in_channels=250, out_channels=500, kernel_size=(10, 10))
        self.conv4 = nn.Conv2d(in_channels=500, out_channels=1000, kernel_size=(10, 10))

        self.relu = nn.ReLU()
        self.bn1 = nn.BatchNorm2d(100)
        self.bn2 = nn.BatchNorm2d(250)
        self.bn3 = nn.BatchNorm2d(500)
        self.bn4 = nn.BatchNorm2d(1000)

        self.pool = nn.MaxPool2d(kernel_size=(2, 2))
        self.global_avg_pool = nn.AdaptiveAvgPool2d((1, 1))
        self.dropout1 = nn.Dropout(0.5)
        self.fc = nn.Linear(1000, num_classes)
        self.sigmoid = nn.Sigmoid()

    def forward(self, x):
        x = self.pool(self.relu(self.bn1(self.conv1(x))))
        x = self.dropout1(x)

        x = self.pool(self.relu(self.bn2(self.conv2(x))))
        x = self.dropout1(x)

        x = self.pool(self.relu(self.bn3(self.conv3(x))))
        x = self.dropout1(x)

        x = self.pool(self.relu(self.bn4(self.conv4(x))))
        x = self.global_avg_pool(x)
        x = x.view(x.size(0), -1)  # Flatten
        x = self.dropout1(x)
        x = self.fc(x)
        x = self.sigmoid(x)
        return x

### ğŸ“Š ëª¨ë¸ ë¹„êµ ê²°ê³¼
- CNN ëª¨ë¸ì´ ì „ë°˜ì ì¸ Accuracy ë° Recallì—ì„œ ê°€ì¥ ìš°ìˆ˜
- íŠ¹íˆ HCM í´ë˜ìŠ¤(ì†Œìˆ˜ í´ë˜ìŠ¤)ì˜ Recallì„ íš¨ê³¼ì ìœ¼ë¡œ í–¥ìƒì‹œí‚´
<img src="https://github.com/user-attachments/assets/ca406632-eff9-44b7-bd77-13a1a1d9884c" width="350"/>
---

### ğŸ§ª CNN êµ¬ì¡°ë³„ ì„±ëŠ¥ ë¹„êµ

- ë‹¤ì–‘í•œ CNN êµ¬ì¡° ì‹¤í—˜ ê²°ê³¼, **Layer-5 / out_1024 / SEBlock** ëª¨ë¸ì´ ê°€ì¥ ìš°ìˆ˜í•œ ì„±ëŠ¥ ê¸°ë¡
- Recall ë° Loss ëª¨ë‘ ê°œì„ 

---

### âœ… ìµœì¢… ëª¨ë¸ ì„±ëŠ¥
- **êµ¬ì„±**: CNN + SEBlock  
- **ì„¤ì •**: Class Weight 3:1, Epoch 50, Batch Size 64, Learning Rate 0.002  
- **ìµœì¢… ì„±ëŠ¥**:
  - Accuracy: 0.9457
  - Loss: 0.1602
  - Recall: 0.8461 / 0.9701
  - **F1-Score: 0.8618 / 0.9666**
<img src="https://github.com/user-attachments/assets/be026a83-f4a7-4d6e-b610-5e3cb25ed903" width="350"/>
---

## ğŸ§¾ ê²°ë¡  ë° ê¸°ëŒ€ íš¨ê³¼

- ë‹¤ì–‘í•œ **ë¶ˆê· í˜• ì²˜ë¦¬ ê¸°ë²•ê³¼ ì•„í‚¤í…ì²˜ ìµœì í™”**ë¥¼ í†µí•´  
  **ì •ìƒ vs ì‹¬ê·¼ ë¹„ëŒ€ì¦(HCM)** ì´ì§„ ë¶„ë¥˜ì—ì„œ **ì†Œìˆ˜ í´ë˜ìŠ¤ì˜ ì„±ëŠ¥ì„ íš¨ê³¼ì ìœ¼ë¡œ í–¥ìƒ**
- ì˜ë£Œ ë°ì´í„° íŠ¹ì„±ìƒ **ë°ì´í„° ì¦ê°• ì—†ì´ë„** ì‹ ë¢°ì„± ìˆëŠ” ê²°ê³¼ë¥¼ ë„ì¶œ
- ì•ìœ¼ë¡œì˜ ì—°êµ¬ì—ì„œëŠ” í•´ë‹¹ ëª¨ë¸ì„ ì‹¤ì‹œê°„ ì§„ë‹¨, ì˜ë£Œê¸°ê¸° ì—°ë™ ë“± **ì˜ë£Œ í˜„ì¥ì— ì ìš© ê°€ëŠ¥í•œ í˜•íƒœë¡œ í™•ì¥**í•  ì˜ˆì •

> ë³¸ ì—°êµ¬ëŠ” AI ê¸°ë°˜ ì˜ë£Œ ì§„ë‹¨ì—ì„œ **ë°ì´í„° ë¶ˆê· í˜•ì´ë¼ëŠ” í˜„ì‹¤ì ì¸ ë¬¸ì œë¥¼ í•´ê²°í•˜ë©°**,  
> **ì‹ ë¢°ì„± ìˆê³  ì„ìƒì ìœ¼ë¡œ í™œìš© ê°€ëŠ¥í•œ ëª¨ë¸ ì„¤ê³„ì˜ ê°€ëŠ¥ì„±**ì„ ë³´ì—¬ì£¼ì—ˆìŠµë‹ˆë‹¤.




